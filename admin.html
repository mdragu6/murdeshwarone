<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Analytics</title>
<style>
body{font-family:Arial;background:#F1F5F9;padding:20px}
.card{background:#fff;padding:15px;border-radius:12px;margin-bottom:12px}
</style>
</head>
<body>

<div id="login">
<h2>Admin Login</h2>
<input id="pass" type="password" placeholder="Enter password">
<button onclick="check()">Login</button>
</div>

<div id="dashboard" style="display:none">
<h2>Listing Analytics</h2>
<div id="analytics"></div>
</div>

<script>
/* CHANGE PASSWORD HERE */
const ADMIN_PASSWORD="murdeshwar123";

function check(){
  const p=document.getElementById("pass").value;

  if(p===ADMIN_PASSWORD){
    document.getElementById("login").style.display="none";
    document.getElementById("dashboard").style.display="block";
    loadAnalytics();
  }else{
    alert("Wrong password");
  }
}

const SHEET_ID="1NfFwlfVukVQoujYuz7GkbK92FMYa1nQVYLOvjgr8qMw";

function loadAnalytics(){
fetch(`https://opensheet.elk.sh/${SHEET_ID}/analytics`)
.then(res=>res.json())
.then(data=>{

  const stats={};

  data.forEach(e=>{
    const name=e.name;

    if(!stats[name]){
      stats[name]={view:0,call:0,whatsapp:0};
    }

    if(e.event==="view") stats[name].view++;
    if(e.event==="call") stats[name].call++;
    if(e.event==="whatsapp") stats[name].whatsapp++;
  });

  document.getElementById("analytics").innerHTML=
    Object.keys(stats).map(name=>`
      <div class="card">
        <b>${name}</b><br>
        Views: ${stats[name].view}<br>
        Calls: ${stats[name].call}<br>
        WhatsApp: ${stats[name].whatsapp}
      </div>
    `).join("");
});
}
</script>

</body>
</html>
